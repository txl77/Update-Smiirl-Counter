name: Update Smiirl Counter

on:
  schedule:
    - cron: '0 * * * *'
  workflow_dispatch:

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: Get followers from Social Blade and update npoint
        run: |
          FOLLOWERS=$(curl -s "https://socialblade.com/instagram/user/uefrance" | grep -oP '"followers":"\K[0-9]+' | head -1)
          echo "Followers: $FOLLOWERS"
          curl -X POST https://api.npoint.io/5c1ef38596efbfb2bfe9 \
            -H "Content-Type: application/json" \
            -d "{\"number\": $FOLLOWERS}"
          echo "Updated npoint!"
